---
title: "Daten explorieren (1)"
author: "Peter Baumgartner"
date: "2017-03-20"
output: 
        html_notebook:
                toc: yes
                toc_depth: 3
                
---
***

```{r label = "global-options", echo=FALSE, highlight=TRUE}
knitr::opts_chunk$set(
        message = F,
        error = F,
        warning = F,
        comment = NA,
        highlight = T,
        prompt = T
        )

if (!require("tidyverse")) 
        {install.packages("tidyverse", repos = 'http://cran.wu.ac.at/')
        library(tidyverse)}
if (!require("reshape2"))
        {install.packages("reshape2", repos = 'http://cran.wu.ac.at/')
        library(reshape2)}
if (!require("readxl"))
        {install.packages("readxl", repos = 'http://cran.wu.ac.at/')
        library(readxl)}
if (!require("pander"))
        {install.packages("pander", repos = 'http://cran.wu.ac.at/')
        library(pander)}


```

# Daten einspielen

Die Daten sind nun in einem R lesbaren Format bereinigt und als `tidy data` vorhanden. Sie können nun in R geladen werden.


```{r lade-daten}
umfrage <- readRDS("../daten/umfrage.rds")

```


Die Daten können nun entsprechend ihrer Struktur inspiziert werden.

```{r inspiziere-daten}
str(umfrage)
```

```{r}
ggplot(umfrage, aes(t.pc.ja, fill = t.pc.ja)) +
        geom_bar() 
ggplot(umfrage, aes(t.pc.ja, fill = t.pc.ja)) +
        geom_bar() + 
        theme(axis.text.x = element_text(angle = -30, vjust = 1, hjust = 0)) +
        facet_wrap(~schultyp)
```



Die Datei hat ingesamt `r nrow(umfrage)` (Reihen), das sind "Beobachtungen", d.h. befragte Personen. Es gibt `r ncol(umfrage)` Spalten das sind Variable.

Der Datensatz gliedert sich in 5 große Bereiche:

1. Allgemeine Fragen: Variable `schultyp` (F1) und Einsatz von Medien im Unterricht (F2). Diese Frage fehlt mir aber !?
2. Fragen zur Technik-Ausstattung: 8 Variablen die mit "t." beginnen. 
3. Fragen zu vorhandenen Kompetenzen: 6 Variablen, die mit "k." beginnen.
4. Fragen zu Wünschen: 15 Variablen, die mit "w." beginnen.
5. Fragen zu Interessen: 6 Variablen, die mit ".i" beginnen.
6. Fragen direkt zur Nutzung von Audiemus: 15 Variablen, die mit "a." beginnen.

# Explorative Beschreibung durch Visualisierung

## Allgemeine Anmerkung
Die deskriptive Auswertung der einzelnen Variablen gibt es bereits bei SurveyMonkey. Trotzdem ist es vielleicht sinnvoll, diese Grafiken hier nochmals darzustellen und für einen Bericht schön aufzubereiten. Im Augenblick allerdings dienen die Grafiken nur der visuellen Exploration und dem Generieren von Ideen für Zusammenhänge. Deshalb achte ich zur Zeit auch nicht auf optimales Aussehen.

Die nachfolgenden Grafiken sind erst rudimentär ausgearbeitet. Das betrifft insbesondere 

* Titel und Untertitel und eventuelle Referenz der Grafik
* Größen (Länge/Breite)
* Beschriftung der Axen
* Text und Darstellung der Legende
* Graustufen (Druck) bzw. Farbskala (auch für Farbbline!)
* etc.

Allerdings versuche ich eine prototypischen Grafik zu entwickeln, die alle Elemente, die für die spätere Darstellung wichtig sind, bereits enthält. Die entsprechenden Elemente haben noch keine inhalltiche Genauigkeit, sondern sind nur als Platzhalter gedacht. 

## Entwicklung eines Prototyps für die grafische Darstellung

### Balkendiagramm

Für die Darstellung von qualitativen Variablen eigenen sich am Besten Balkendiagramme. 

## Verteilung nach Schultyp

```{r}
ggplot(umfrage, aes(schultyp)) +
        geom_bar()
```

## Technische Ausstattung

Frage: "Wie ist Ihre Schule aus digitaler Sicht technisch ausgerüstet?"

1 = sehr gut
2 = ausreichend
3 = ausbaufähig
4 = schlecht
5 = nicht vorhanden

```{r}
ggplot(umfrage, aes(t.pc.ja, fill = t.pc.ja)) +
        geom_bar() 
ggplot(umfrage, aes(t.pc.ja, fill = t.pc.ja)) +
        geom_bar() + 
        theme(axis.text.x = element_text(angle = -30, vjust = 1, hjust = 0)) +
        facet_wrap(~schultyp)
```
Die Ausstattung mit PC ist relativ gut. Nur 6 Schulen meinen, dass sie ausbaufähig (3) sei. Schlechtere Bewertungen aus "ausbaufähig" gibt es nicht.

Schöner als obige Darstellung wäre eine Grafik, wo es für jeden Schultyp nur einen Balken gibt, der sich nach diesen drei Abstufen farblich unterteilt und sich - zum besseren Vergleich - bei allen drei Schultypen zu einer Normgröße (= Gesamtzahl der Antworten dieser Schultype bzw. 100%) aufsummiert. 

**Frage:** Wie lässt sich solch eine Grafik in R erstellen?

```{r}
ggplot(data = umfrage) +
        geom_bar(
                mapping = aes(x = schultyp, fill = t.pc.ja),
                position = "fill"
                )
```
Wenn ich obigen Programmcode entsprechend ändere, kann ich alle Variablen nach obigen Muster entsprechend "durch deklinieren". Das muss ich aber auf morgen verschieben.

```{r}
ggplot(umfrage, aes(t.pc.nein, fill = t.pc.nein)) +
        geom_bar() +
        scale_fill_discrete(labels = c("Eins", "Zwei", "Drei", "Vier", "Fünf") ) +
        scale_x_discrete(labels = c("Eins", "Zwei", "Drei", "Vier", "Fünf") )

ggplot(umfrage, aes(t.pc.nein, fill = t.pc.nein)) +
        geom_bar()
```

